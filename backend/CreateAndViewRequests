# Add json data via Postman to the requests
@app.route("/createRequest/<oldManagerEmail>/<newManagerEmail>/<oldManagerID>/<newManagerID>/<employeeID>", methods=["POST"])
def create_request(oldManagerEmail, newManagerEmail, oldManagerID, newManagerID, employeeID):
    rcollection = db["Requests"]

    sendRequest = []
    sendRequest.append({"employeeID": employeeID, "oldManager": oldManagerID, "newManager": newManagerID, "oldManagerEmail": oldManagerEmail, "newManagerEmail": newManagerEmail, "status": "pending"})
    rcollection.insert_many(sendRequest)
    return "Done"

# Find a request given to the logged in user.
@app.route("/viewRecievedRequests/<email>", methods=["GET"])
def view_recieved_requests(email):
    rcollection = db["Requests"] 
    current_emp = collection.find_one({"email": email})  

    targetRequests = [] 
    all_requests = rcollection.find({"newManager": current_emp["employeeId"]})

    for requests in all_requests:
        targetRequests.append({"EmployeeID": requests["employeeId"], "OldManager": requests["oldManager"], "NewManager": requests["newManager"], "OldManagerEmail": requests["oldManagerEmail"], "NewManagerEmail": requests["newManagerEmail"], "Status": requests["status"]})
    return jsonify({"ViewRecievedRequests": targetRequests})


# Find a request given to the logged in user.
@app.route("/viewSentRequests/<email>", methods=["GET"])
def view_sent_requests(email):
    rcollection = db["Requests"] 
    current_emp = collection.find_one({"email": email})  

    targetRequests = [] 
    all_requests = rcollection.find({"oldManager": current_emp["employeeId"]})

    for requests in all_requests:
        targetRequests.append({"EmployeeID": requests["employeeId"], "OldManager": requests["oldManager"], "NewManager": requests["newManager"], "OldManagerEmail": requests["oldManagerEmail"], "NewManagerEmail": requests["newManagerEmail"], "Status": requests["status"]})
    return jsonify({"ViewRecievedRequests": targetRequests})

